{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tdegi\\\\OneDrive\\\\Desktop\\\\Bootcamp\\\\Repository\\\\Shop-Shop\\\\client\\\\src\\\\components\\\\Cart\\\\index.js\";\nimport React, { useEffect } from 'react';\nimport CartItem from '../CartItem';\nimport Auth from '../../utils/auth';\nimport './style.css';\nimport { useStoreContext } from '../../utils/GlobalState';\nimport { TOGGLE_CART, ADD_MULTIPLE_TO_CART } from '../../utils/actions';\nimport { idbPromise } from '../../utils/helpers';\nimport { QUERY_CHECKOUT } from '../../utils/queries';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useLazyQuery } from '@apollo/client';\nconst stripePromise = loadStripe('pk_test_TYooMQauvdEDq54NiTphI7jx');\nconst Cart = () => {\n  const [state, dispatch] = useStoreContext();\n  const [getCheckout, {\n    data\n  }] = useLazyQuery(QUERY_CHECKOUT);\n  useEffect(() => {\n    async function getCart() {\n      const cart = await idbPromise('cart', 'get');\n      dispatch({\n        type: ADD_MULTIPLE_TO_CART,\n        products: [...cart]\n      });\n    }\n    ;\n    if (!state.cart.length) {\n      getCart();\n    }\n  }, [state.cart.length, dispatch]);\n  useEffect(() => {\n    if (data) {\n      stripePromise.then(res => {});\n    }\n  });\n  function toggleCart() {\n    dispatch({\n      type: TOGGLE_CART\n    });\n  }\n  function calculateTotal() {\n    let sum = 0;\n    state.cart.forEach(item => {\n      sum += item.price * item.purchaseQuantity;\n    });\n    return sum.toFixed(2);\n  }\n  function submitCheckout() {\n    const productIds = [];\n    state.cart.forEach(item => {\n      for (let i = 0; i < item.purchaseQuantity; i++) {\n        productIds.push(item._id_);\n      }\n    });\n    getCheckout({\n      variables: {\n        products: productIds\n      }\n    });\n  }\n  if (!state.cartOpen) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"cart-closed\",\n      onClick: toggleCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      role: \"img\",\n      \"aria-label\": \"trash\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 13\n      }\n    }, \"\\uD83D\\uDED2\"));\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"close\",\n    onClick: toggleCart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, \"[close]\"), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, \"Shopping Cart\"), state.cart.length ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }, state.cart.map(item => /*#__PURE__*/React.createElement(CartItem, {\n    key: item._id,\n    item: item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-row space-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, \"Total: $\", calculateTotal()), Auth.loggedIn() ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: submitCheckout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, \"Checkout\") : /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }, \"(log in to check out)\"))) : /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    role: \"img\",\n    \"aria-label\": \"shocked\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, \"\\uD83D\\uDE31\"), \"You haven't added anything to your cart yet!\"));\n};\nexport default Cart;","map":{"version":3,"names":["React","useEffect","CartItem","Auth","useStoreContext","TOGGLE_CART","ADD_MULTIPLE_TO_CART","idbPromise","QUERY_CHECKOUT","loadStripe","useLazyQuery","stripePromise","Cart","state","dispatch","getCheckout","data","getCart","cart","type","products","length","then","res","toggleCart","calculateTotal","sum","forEach","item","price","purchaseQuantity","toFixed","submitCheckout","productIds","i","push","_id_","variables","cartOpen","map","_id","loggedIn"],"sources":["C:/Users/tdegi/OneDrive/Desktop/Bootcamp/Repository/Shop-Shop/client/src/components/Cart/index.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport CartItem from '../CartItem';\r\nimport Auth from '../../utils/auth';\r\nimport './style.css';\r\nimport { useStoreContext } from '../../utils/GlobalState';\r\nimport { TOGGLE_CART, ADD_MULTIPLE_TO_CART } from '../../utils/actions';\r\nimport { idbPromise } from '../../utils/helpers';\r\nimport { QUERY_CHECKOUT } from '../../utils/queries';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport { useLazyQuery } from '@apollo/client';\r\n\r\nconst stripePromise = loadStripe('pk_test_TYooMQauvdEDq54NiTphI7jx');\r\n\r\nconst Cart = () => {\r\n    const [state, dispatch] = useStoreContext();\r\n    const [getCheckout, { data }] = useLazyQuery(QUERY_CHECKOUT);\r\n\r\n    useEffect(() => {\r\n        async function getCart() {\r\n            const cart = await idbPromise('cart', 'get');\r\n            dispatch({ type: ADD_MULTIPLE_TO_CART, products: [...cart] });\r\n        };\r\n\r\n        if (!state.cart.length) {\r\n            getCart();\r\n        }\r\n    }, [state.cart.length, dispatch]);\r\n\r\n    useEffect(() => {\r\n        if (data) {\r\n            stripePromise.then((res) => {\r\n                \r\n            })\r\n        }\r\n    })\r\n\r\n    function toggleCart() {\r\n        dispatch({ type: TOGGLE_CART });\r\n    }\r\n\r\n    function calculateTotal() {\r\n        let sum = 0;\r\n        state.cart.forEach(item => {\r\n            sum += item.price * item.purchaseQuantity;\r\n        });\r\n        return sum.toFixed(2);\r\n    }\r\n\r\n    function submitCheckout() {\r\n        const productIds = [];\r\n\r\n        state.cart.forEach((item) => {\r\n            for (let i=0; i<item.purchaseQuantity; i++){\r\n                productIds.push(item._id_);\r\n            }\r\n        });\r\n\r\n        getCheckout({\r\n            variables: { products: productIds }\r\n        });\r\n    }\r\n\r\n    if (!state.cartOpen) {\r\n        return (\r\n          <div className=\"cart-closed\" onClick={toggleCart}>\r\n            <span\r\n              role=\"img\"\r\n              aria-label=\"trash\">ðŸ›’</span>\r\n          </div>\r\n        );\r\n      }\r\n\r\n  return (\r\n    <div className=\"cart\">\r\n    <div className=\"close\" onClick={toggleCart}>[close]</div>\r\n    <h2>Shopping Cart</h2>\r\n    {state.cart.length ? (\r\n        <div>\r\n        {state.cart.map(item => (\r\n            <CartItem key={item._id} item={item} />\r\n        ))}\r\n        <div className=\"flex-row space-between\">\r\n            <strong>Total: ${calculateTotal()}</strong>\r\n            {\r\n            Auth.loggedIn() ?\r\n                <button onClick={submitCheckout}>\r\n                Checkout\r\n                </button>\r\n                :\r\n                <span>(log in to check out)</span>\r\n            }\r\n        </div>\r\n        </div>\r\n    ) : (\r\n        <h3>\r\n        <span role=\"img\" aria-label=\"shocked\">\r\n            ðŸ˜±\r\n        </span>\r\n        You haven't added anything to your cart yet!\r\n        </h3>\r\n    )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cart;"],"mappings":"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"},"metadata":{},"sourceType":"module"}